<script>
    const articles = @json($articles);
    let articleIndex = 1;
    document.getElementById('addArticleButton').addEventListener('click', function() {
        const container = document.getElementById('articlesContainer');

        let selectOptions = <option value="">Sélectionnez un article</option>;
        articles.forEach(article => {
            selectOptions += <option value="${article.ArtId}">${article.ArtLibelle}</option>;
        });

        const newArticle = `

<div id="articlesContainer">
                            <div class="d-flex align-items-center mb-2">
                                <select name="articles[${articleIndex}][ArtId]" class="form-control" required>
                                    ${selectOptions}
        </select>
        <input type="number" name="articles[${articleIndex}][quantity]" class="form-control ml-2" placeholder="Quantité" min="1" required style="width: 100px;">
        <button type="button" class="btn btn-danger btn-sm ml-2 remove-article">Supprimer</button>
    </div>
</div>
`;

        container.insertAdjacentHTML('beforeend', newArticle);
        articleIndex++;
    });

    // Fonction pour supprimer un article
    document.addEventListener('click', function(event) {
        if (event.target && event.target.classList.contains('remove-article')) {
            event.target.parentElement.remove();
        }
    });

    // Récupérer les articles sélectionnés et leurs quantités
    document.getElementById('getSelectedArticles').addEventListener('click', function() {
        const selectedArticles = []; // Tableau pour stocker les articles sélectionnés

        // Récupérer tous les sélecteurs d'articles et les quantités
        const articleSelects = document.querySelectorAll('select[name^="articles"]');
        const quantityInputs = document.querySelectorAll('input[name^="articles"][name$="[quantity]"]');

        // Parcourir chaque sélecteur et récupérer l'ID de l'article et la quantité correspondante
        for (let i = 0; i < articleSelects.length; i++) {
            const articleId = articleSelects[i].value;  // ID de l'article sélectionné
            const quantity = quantityInputs[i].value;   // Quantité saisie

            if (articleId && quantity) { // Vérifier que l'article et la quantité sont valides
                selectedArticles.push({
                    articleId: articleId,
                    quantity: quantity
                });
            }
        }

        console.log(selectedArticles); // Affiche les articles sélectionnés dans la console
        // Tu peux ici envoyer les données au serveur, par exemple via AJAX
    });


</script>
